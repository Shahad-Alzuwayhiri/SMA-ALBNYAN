{% extends "base.html" %}
{% block title %}ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¹Ù‚Ø¯{% endblock %}
{% block extra_head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/contracts_modern.css') }}">
{% endblock %}
{% block content %}
<div class="dashboard-layout">
  <div class="sidebar">
    <a href="{{ url_for('dashboard') }}" class="icon active" title="Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©">ğŸ </a>
    <a href="{{ url_for('contracts_list') }}" class="icon" title="Ø§Ù„Ø¹Ù‚ÙˆØ¯">ğŸ“„</a>
    <a href="{{ url_for('contracts_in_progress') }}" class="icon" title="ØªØ­Øª Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡">â³</a>
    <a href="{{ url_for('contracts_closed') }}" class="icon" title="Ù…ØºÙ„Ù‚Ø©">âŒ</a>
    <a href="{{ url_for('notifications') }}" class="icon" title="Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª">ğŸ””</a>
    <a href="{{ url_for('profile') }}" class="icon" title="Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ">ğŸ‘¤</a>
    <a href="{{ url_for('logout') }}" class="icon" title="Ø®Ø±ÙˆØ¬">ğŸšª</a>
  </div>
  <div class="dashboard-main">
    <div class="modern-header" style="display:flex;justify-content:flex-start;align-items:center;gap:12px;">
      {% from '_macros.html' import back_button %}{{ back_button() }}
      <h3 style="margin:0;color:var(--sama-primary)">ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¹Ù‚Ø¯</h3>
    </div>
  {# body class controlled centrally in base.html via auth_page #}

    <div class="container">
      <div class="card p-3" style="display:flex;gap:20px;align-items:flex-start;flex-direction:column;">
        <!-- top: account header (matches mockup spacing) -->
        <div style="display:flex;align-items:center;justify-content:space-between;width:100%">
          <div style="display:flex;align-items:center;gap:12px">
            <div style="width:64px;height:64px;border-radius:50%;background:#f3f4f6;display:flex;align-items:center;justify-content:center;font-weight:700;color:var(--sama-primary)">Ø¹</div>
            <div>
              <div style="font-weight:700">{{ item.title or 'Ø§Ù„Ø¹Ù‚Ø¯' }}</div>
              <div style="color:var(--sama-muted);font-size:13px">ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù‚Ø¯</div>
            </div>
          </div>
          <div style="display:flex;gap:10px">
            <a class="btn btn-light" href="{{ url_for('contracts_list') }}">Ø¥Ù„ØºØ§Ø¡</a>
            <button form="main-form" class="btn btn-primary" name="action" value="save">Ø­ÙØ¸</button>
          </div>
        </div>
        <form id="main-form" method="POST" class="" style="width:100%">
          <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
          <div class="mb-3">
            <label class="form-label">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label>
            <input name="title" class="form-control" required value="{{ item.title|default('') }}">
          </div>
          <div class="mb-3">
            <label class="form-label">Ù†Øµ Ø§Ù„Ø¹Ù‚Ø¯</label>
            <textarea name="content" class="form-control" rows="12" required>{{ item.content|default('') }}</textarea>
          </div>
          <div class="row g-2">
            <div class="col-md-4">
              <label class="form-label">Ø§Ù„Ø¹Ù…ÙŠÙ„</label>
              <input name="client_name" class="form-control" value="{{ item.client_name|default('') }}">
            </div>
            <div class="col-md-4">
              <label class="form-label">Ø§Ù„Ù‡ÙˆÙŠØ©/Ø§Ù„Ø³Ø¬Ù„</label>
              <input name="client_id_number" class="form-control" value="{{ item.client_id_number|default('') }}">
            </div>
            <div class="col-md-4">
              <label class="form-label">Ø§Ù„Ø¬ÙˆØ§Ù„</label>
              <input name="client_phone" class="form-control" value="{{ item.client_phone|default('') }}">
            </div>
            <div class="col-md-6">
              <label class="form-label">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label>
              <input name="client_address" class="form-control" value="{{ item.client_address|default('') }}">
            </div>
            <div class="col-md-6">
              <label class="form-label">Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©</label>
              <input name="investment_amount" class="form-control" value="{{ item.investment_amount|default('') }}" inputmode="decimal" placeholder="Ù…Ø«Ø§Ù„: 250000">
              {% if item.investment_amount %}
                <div class="form-text" style="display:flex;align-items:center;gap:6px;margin-top:4px;">
                  <span>
                    {% set amount = item.investment_amount|default('0') %}
                    {{ "{:,.2f}".format(amount|float) }}
                  </span>
                  <img src="{{ url_for('static', filename='img/Saudi_Riyal_Symbol.svg.png') }}" 
                    alt="SAR" style="height:18px;vertical-align:middle;margin-right:4px;">
                </div>
              {% endif %}
            </div>
          </div>
          <div class="btn-row">
            <button class="btn btn-secondary" name="action" value="preview" type="submit">ğŸ‘ Ù…Ø¹Ø§ÙŠÙ†Ø©</button>
            <button class="btn btn-primary"   name="action" value="save"    type="submit">Ø­ÙØ¸</button>
            <button class="btn btn-outline-primary" name="action" value="save_back" type="submit">Ø­ÙØ¸ ÙˆØ§Ù„Ø±Ø¬ÙˆØ¹</button>
            <button class="btn btn-success"   name="action" value="save_pdf" type="submit">Ø­ÙØ¸ + PDF</button>
            <a class="btn btn-light" href="{{ url_for('contracts_list') }}">Ø¥Ù„ØºØ§Ø¡</a>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
{% endblock %}